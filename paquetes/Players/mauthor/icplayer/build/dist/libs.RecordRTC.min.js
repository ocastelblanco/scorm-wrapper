"use strict";function RecordRTC(q,i){if(!q){throw"First parameter is required.";}i=i||{type:"video"};i=new RecordRTCConfiguration(q,i);var p=this;function h(r){if(!!r){i=new RecordRTCConfiguration(q,r);}if(!i.disableLogs){console.log("started recording "+i.type+" stream.");}if(c){c.clearRecordedData();c.record();k("recording");if(p.recordingDuration){l();}return p;}b(function(){if(p.recordingDuration){l();}});return p;}function b(r){if(r){i.initCallback=function(){r();r=i.initCallback=null;};}var s=new GetRecorderType(q,i);c=new s(q,i);c.record();k("recording");if(!i.disableLogs){console.log("Initialized recorderType:",c.constructor.name,"for output-type:",i.type);}}function m(s){s=s||function(){};if(!c){d();return;}if(p.state==="paused"){p.resumeRecording();setTimeout(function(){m(s);},1);return;}if(p.state!=="recording"&&!i.disableLogs){console.warn('Recording state should be: "recording", however current state is: ',p.state);}if(!i.disableLogs){console.log("Stopped recording "+i.type+" stream.");}if(i.type!=="gif"){c.stop(r);}else{c.stop();r();}k("stopped");function r(v){if(!c){if(typeof s.call==="function"){s.call(p,"");}else{s("");}return;}Object.keys(c).forEach(function(w){if(typeof c[w]==="function"){return;}p[w]=c[w];});var t=c.blob;if(!t){if(v){c.blob=t=v;}else{throw"Recording failed.";}}if(t&&!i.disableLogs){console.log(t.type,"->",bytesToSize(t.size));}if(s){var u=URL.createObjectURL(t);if(typeof s.call==="function"){s.call(p,u);}else{s(u);}}if(!i.autoWriteToDisk){return;}f(function(w){var x={};x[i.type+"Blob"]=w;DiskStorage.Store(x);});}}function n(){if(!c){d();return;}if(p.state!=="recording"){if(!i.disableLogs){console.warn("Unable to pause the recording. Recording state: ",p.state);}return;}k("paused");c.pause();if(!i.disableLogs){console.log("Paused recording.");}}function g(){if(!c){d();return;}if(p.state!=="paused"){if(!i.disableLogs){console.warn("Unable to resume the recording. Recording state: ",p.state);}return;}k("recording");c.resume();if(!i.disableLogs){console.log("Resumed recording.");}}function o(r){postMessage(new FileReaderSync().readAsDataURL(r));}function f(w,u){if(!w){throw"Pass a callback function over getDataURL.";}var t=u?u.blob:(c||{}).blob;if(!t){if(!i.disableLogs){console.warn("Blob encoder did not finish its job yet.");}setTimeout(function(){f(w,u);},1000);return;}if(typeof Worker!=="undefined"&&!navigator.mozGetUserMedia){var s=v(o);s.onmessage=function(x){w(x.data);};s.postMessage(t);}else{var r=new FileReader();r.readAsDataURL(t);r.onload=function(x){w(x.target.result);};}function v(x){var y=URL.createObjectURL(new Blob([x.toString(),"this.onmessage =  function (e) {"+x.name+"(e.data);}"],{type:"application/javascript"}));var z=new Worker(y);URL.revokeObjectURL(y);return z;}}function l(r){r=r||0;if(p.state==="paused"){setTimeout(function(){l(r);},1000);return;}if(p.state==="stopped"){return;}if(r>=p.recordingDuration){m(p.onRecordingStopped);return;}r+=1000;setTimeout(function(){l(r);},1000);}function k(r){if(!p){return;}p.state=r;if(typeof p.onStateChanged.call==="function"){p.onStateChanged.call(p,r);}else{p.onStateChanged(r);}}var e='It seems that recorder is destroyed or "startRecording" is not invoked for '+i.type+" recorder.";function d(){if(i.disableLogs===true){return;}console.warn(e);}var c;var j={startRecording:h,stopRecording:m,pauseRecording:n,resumeRecording:g,initRecorder:b,setRecordingDuration:function(r,s){if(typeof r==="undefined"){throw"recordingDuration is required.";}if(typeof r!=="number"){throw"recordingDuration must be a number.";}p.recordingDuration=r;p.onRecordingStopped=s||function(){};return{onRecordingStopped:function(t){p.onRecordingStopped=t;}};},clearRecordedData:function(){if(!c){d();return;}c.clearRecordedData();if(!i.disableLogs){console.log("Cleared old recorded data.");}},getBlob:function(){if(!c){d();return;}return c.blob;},getDataURL:f,toURL:function(){if(!c){d();return;}return URL.createObjectURL(c.blob);},getInternalRecorder:function(){return c;},save:function(r){if(!c){d();return;}invokeSaveAsDialog(c.blob,r);},getFromDisk:function(r){if(!c){d();return;}RecordRTC.getFromDisk(i.type,r);},setAdvertisementArray:function(t){i.advertisement=[];var s=t.length;for(var r=0;r<s;r++){i.advertisement.push({duration:r,image:t[r]});}},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){if(c&&typeof c.clearRecordedData==="function"){c.clearRecordedData();}c=null;k("inactive");p.blob=null;},onStateChanged:function(r){if(!i.disableLogs){console.log("Recorder state changed:",r);}},state:"inactive",getState:function(){return p.state;},destroy:function(){var r=i.disableLogs;i={disableLogs:true};p.reset();k("destroyed");j=p=null;if(Storage.AudioContextConstructor){Storage.AudioContextConstructor.close();Storage.AudioContextConstructor=null;}i.disableLogs=r;if(!i.disableLogs){console.warn("RecordRTC is destroyed.");}},version:"5.4.7"};if(!this){p=j;return j;}for(var a in j){this[a]=j[a];}p=this;return j;}RecordRTC.version="5.4.7";if(typeof module!=="undefined"){module.exports=RecordRTC;}if(typeof define==="function"&&define.amd){define("RecordRTC",[],function(){return RecordRTC;});}RecordRTC.getFromDisk=function(a,b){if(!b){throw"callback is mandatory.";}console.log("Getting recorded "+(a==="all"?"blobs":a+" blob ")+" from disk!");DiskStorage.Fetch(function(d,c){if(a!=="all"&&c===a+"Blob"&&b){b(d);}if(a==="all"&&b){b(d,c.replace("Blob",""));}});};RecordRTC.writeToDisk=function(a){console.log("Writing recorded blob(s) to disk!");a=a||{};if(a.audio&&a.video&&a.gif){a.audio.getDataURL(function(b){a.video.getDataURL(function(c){a.gif.getDataURL(function(d){DiskStorage.Store({audioBlob:b,videoBlob:c,gifBlob:d});});});});}else{if(a.audio&&a.video){a.audio.getDataURL(function(b){a.video.getDataURL(function(c){DiskStorage.Store({audioBlob:b,videoBlob:c});});});}else{if(a.audio&&a.gif){a.audio.getDataURL(function(b){a.gif.getDataURL(function(c){DiskStorage.Store({audioBlob:b,gifBlob:c});});});}else{if(a.video&&a.gif){a.video.getDataURL(function(b){a.gif.getDataURL(function(c){DiskStorage.Store({videoBlob:b,gifBlob:c});});});}else{if(a.audio){a.audio.getDataURL(function(b){DiskStorage.Store({audioBlob:b});});}else{if(a.video){a.video.getDataURL(function(b){DiskStorage.Store({videoBlob:b});});}else{if(a.gif){a.gif.getDataURL(function(b){DiskStorage.Store({gifBlob:b});});}}}}}}}};function RecordRTCConfiguration(a,b){if(!b.recorderType&&!b.type){if(!!b.audio&&!!b.video){b.type="video";}else{if(!!b.audio&&!b.video){b.type="audio";}}}if(b.recorderType&&!b.type){if(b.recorderType===WhammyRecorder||b.recorderType===CanvasRecorder){b.type="video";}else{if(b.recorderType===GifRecorder){b.type="gif";}else{if(b.recorderType===StereoAudioRecorder){b.type="audio";}else{if(b.recorderType===MediaStreamRecorder){if(a.getAudioTracks().length&&a.getVideoTracks().length){b.type="video";}else{if(a.getAudioTracks().length&&!a.getVideoTracks().length){b.type="audio";}else{if(!a.getAudioTracks().length&&a.getVideoTracks().length){b.type="audio";}else{}}}}}}}}if(typeof MediaStreamRecorder!=="undefined"&&typeof MediaRecorder!=="undefined"&&"requestData" in MediaRecorder.prototype){if(!b.mimeType){b.mimeType="video/webm";}if(!b.type){b.type=b.mimeType.split("/")[0];}if(!b.bitsPerSecond){}}if(!b.type){if(b.mimeType){b.type=b.mimeType.split("/")[0];}if(!b.type){b.type="audio";}}return b;}function GetRecorderType(b,c){var a;if(isChrome||isEdge||isOpera){a=StereoAudioRecorder;}if(typeof MediaRecorder!=="undefined"&&"requestData" in MediaRecorder.prototype&&!isChrome){a=MediaStreamRecorder;
}if(c.type==="video"&&(isChrome||isOpera)){a=WhammyRecorder;}if(c.type==="gif"){a=GifRecorder;}if(c.type==="canvas"){a=CanvasRecorder;}if(isMediaRecorderCompatible()&&a!==CanvasRecorder&&a!==GifRecorder&&typeof MediaRecorder!=="undefined"&&"requestData" in MediaRecorder.prototype){if((b.getVideoTracks&&b.getVideoTracks().length)||(b.getAudioTracks&&b.getAudioTracks().length)){if(c.type==="audio"){if(typeof MediaRecorder.isTypeSupported==="function"&&MediaRecorder.isTypeSupported("audio/webm")){a=MediaStreamRecorder;}}else{if(typeof MediaRecorder.isTypeSupported==="function"&&MediaRecorder.isTypeSupported("video/webm")){a=MediaStreamRecorder;}}}}if(b instanceof Array&&b.length){a=MultiStreamRecorder;}if(c.recorderType){a=c.recorderType;}if(!c.disableLogs&&!!a&&!!a.name){console.log("Using recorderType:",a.name||a.constructor.name);}return a;}function MRecordRTC(a){this.addStream=function(b){if(b){a=b;}};this.mediaType={audio:true,video:true};this.startRecording=function(){var b=this.mediaType;var g;var e=this.mimeType||{audio:null,video:null,gif:null};if(typeof b.audio!=="function"&&isMediaRecorderCompatible()&&a.getAudioTracks&&!a.getAudioTracks().length){b.audio=false;}if(typeof b.video!=="function"&&isMediaRecorderCompatible()&&a.getVideoTracks&&!a.getVideoTracks().length){b.video=false;}if(typeof b.gif!=="function"&&isMediaRecorderCompatible()&&a.getVideoTracks&&!a.getVideoTracks().length){b.gif=false;}if(!b.audio&&!b.video&&!b.gif){throw"MediaStream must have either audio or video tracks.";}if(!!b.audio){g=null;if(typeof b.audio==="function"){g=b.audio;}this.audioRecorder=new RecordRTC(a,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:g,mimeType:e.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp});if(!b.video){this.audioRecorder.startRecording();}}if(!!b.video){g=null;if(typeof b.video==="function"){g=b.video;}var f=a;if(isMediaRecorderCompatible()&&!!b.audio&&typeof b.audio==="function"){var d=a.getVideoTracks()[0];if(!!navigator.mozGetUserMedia){f=new MediaStream();f.addTrack(d);if(g&&g===WhammyRecorder){g=MediaStreamRecorder;}}else{f=new MediaStream([d]);}}this.videoRecorder=new RecordRTC(f,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:g,mimeType:e.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp});if(!b.audio){this.videoRecorder.startRecording();}}if(!!b.audio&&!!b.video){var c=this;if(isMediaRecorderCompatible()){c.audioRecorder=null;c.videoRecorder.startRecording();}else{c.videoRecorder.initRecorder(function(){c.audioRecorder.initRecorder(function(){c.videoRecorder.startRecording();c.audioRecorder.startRecording();});});}}if(!!b.gif){g=null;if(typeof b.gif==="function"){g=b.gif;}this.gifRecorder=new RecordRTC(a,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:g,mimeType:e.gif});this.gifRecorder.startRecording();}};this.stopRecording=function(b){b=b||function(){};if(this.audioRecorder){this.audioRecorder.stopRecording(function(c){b(c,"audio");});}if(this.videoRecorder){this.videoRecorder.stopRecording(function(c){b(c,"video");});}if(this.gifRecorder){this.gifRecorder.stopRecording(function(c){b(c,"gif");});}};this.pauseRecording=function(){if(this.audioRecorder){this.audioRecorder.pauseRecording();}if(this.videoRecorder){this.videoRecorder.pauseRecording();}if(this.gifRecorder){this.gifRecorder.pauseRecording();}};this.resumeRecording=function(){if(this.audioRecorder){this.audioRecorder.resumeRecording();}if(this.videoRecorder){this.videoRecorder.resumeRecording();}if(this.gifRecorder){this.gifRecorder.resumeRecording();}};this.getBlob=function(c){var b={};if(this.audioRecorder){b.audio=this.audioRecorder.getBlob();}if(this.videoRecorder){b.video=this.videoRecorder.getBlob();}if(this.gifRecorder){b.gif=this.gifRecorder.getBlob();}if(c){c(b);}return b;};this.destroy=function(){if(this.audioRecorder){this.audioRecorder.destroy();this.audioRecorder=null;}if(this.videoRecorder){this.videoRecorder.destroy();this.videoRecorder=null;}if(this.gifRecorder){this.gifRecorder.destroy();this.gifRecorder=null;}};this.getDataURL=function(d){this.getBlob(function(e){if(e.audio&&e.video){b(e.audio,function(f){b(e.video,function(g){d({audio:f,video:g});});});}else{if(e.audio){b(e.audio,function(f){d({audio:f});});}else{if(e.video){b(e.video,function(f){d({video:f});});}}}});function b(h,i){if(typeof Worker!=="undefined"){var g=c(function f(j){postMessage(new FileReaderSync().readAsDataURL(j));});g.onmessage=function(j){i(j.data);};g.postMessage(h);}else{var e=new FileReader();e.readAsDataURL(h);e.onload=function(j){i(j.target.result);};}}function c(e){var f=URL.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (e) {"+e.name+"(e.data);}"],{type:"application/javascript"}));var h=new Worker(f);var g;if(typeof URL!=="undefined"){g=URL;}else{if(typeof webkitURL!=="undefined"){g=webkitURL;}else{throw"Neither URL nor webkitURL detected.";}}g.revokeObjectURL(f);return h;}};this.writeToDisk=function(){RecordRTC.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder});};this.save=function(b){b=b||{audio:true,video:true,gif:true};if(!!b.audio&&this.audioRecorder){this.audioRecorder.save(typeof b.audio==="string"?b.audio:"");}if(!!b.video&&this.videoRecorder){this.videoRecorder.save(typeof b.video==="string"?b.video:"");}if(!!b.gif&&this.gifRecorder){this.gifRecorder.save(typeof b.gif==="string"?b.gif:"");}};}MRecordRTC.getFromDisk=RecordRTC.getFromDisk;MRecordRTC.writeToDisk=RecordRTC.writeToDisk;if(typeof RecordRTC!=="undefined"){RecordRTC.MRecordRTC=MRecordRTC;}var browserFakeUserAgent="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(a){if(!a){return;}if(typeof window!=="undefined"){return;}if(typeof global==="undefined"){return;}global.navigator={userAgent:browserFakeUserAgent,getUserMedia:function(){}};if(!global.console){global.console={};}if(typeof global.console.log==="undefined"||typeof global.console.error==="undefined"){global.console.error=global.console.log=global.console.log||function(){console.log(arguments);};}if(typeof document==="undefined"){a.document={};document.createElement=document.captureStream=document.mozCaptureStream=function(){var b={getContext:function(){return b;},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return"";}};return b;};a.HTMLVideoElement=function(){};}if(typeof location==="undefined"){a.location={protocol:"file:",href:"",hash:""};}if(typeof screen==="undefined"){a.screen={width:0,height:0};}if(typeof URL==="undefined"){a.URL={createObjectURL:function(){return"";},revokeObjectURL:function(){return"";}};}a.window=global;})(typeof global!=="undefined"?global:null);var requestAnimationFrame=window.requestAnimationFrame;if(typeof requestAnimationFrame==="undefined"){if(typeof webkitRequestAnimationFrame!=="undefined"){requestAnimationFrame=webkitRequestAnimationFrame;}else{if(typeof mozRequestAnimationFrame!=="undefined"){requestAnimationFrame=mozRequestAnimationFrame;}else{if(typeof msRequestAnimationFrame!=="undefined"){requestAnimationFrame=msRequestAnimationFrame;}else{if(typeof requestAnimationFrame==="undefined"){var lastTime=0;requestAnimationFrame=function(e,b){var a=new Date().getTime();var c=Math.max(0,16-(a-lastTime));var d=setTimeout(function(){e(a+c);
},c);lastTime=a+c;return d;};}}}}}var cancelAnimationFrame=window.cancelAnimationFrame;if(typeof cancelAnimationFrame==="undefined"){if(typeof webkitCancelAnimationFrame!=="undefined"){cancelAnimationFrame=webkitCancelAnimationFrame;}else{if(typeof mozCancelAnimationFrame!=="undefined"){cancelAnimationFrame=mozCancelAnimationFrame;}else{if(typeof msCancelAnimationFrame!=="undefined"){cancelAnimationFrame=msCancelAnimationFrame;}else{if(typeof cancelAnimationFrame==="undefined"){cancelAnimationFrame=function(a){clearTimeout(a);};}}}}}var AudioContext=window.AudioContext;if(typeof AudioContext==="undefined"){if(typeof webkitAudioContext!=="undefined"){AudioContext=webkitAudioContext;}if(typeof mozAudioContext!=="undefined"){AudioContext=mozAudioContext;}}var URL=window.URL;if(typeof URL==="undefined"&&typeof webkitURL!=="undefined"){URL=webkitURL;}if(typeof navigator!=="undefined"&&typeof navigator.getUserMedia==="undefined"){if(typeof navigator.webkitGetUserMedia!=="undefined"){navigator.getUserMedia=navigator.webkitGetUserMedia;}if(typeof navigator.mozGetUserMedia!=="undefined"){navigator.getUserMedia=navigator.mozGetUserMedia;}}var isEdge=navigator.userAgent.indexOf("Edge")!==-1&&(!!navigator.msSaveBlob||!!navigator.msSaveOrOpenBlob);var isOpera=!!window.opera||navigator.userAgent.indexOf("OPR/")!==-1;var isSafari=navigator.userAgent.toLowerCase().indexOf("safari/")>-1;var isChrome=(!isOpera&&!isEdge&&!!navigator.webkitGetUserMedia)||isElectron()||isSafari;var MediaStream=window.MediaStream;if(typeof MediaStream==="undefined"&&typeof webkitMediaStream!=="undefined"){MediaStream=webkitMediaStream;}if(typeof MediaStream!=="undefined"){if(!("getVideoTracks" in MediaStream.prototype)){MediaStream.prototype.getVideoTracks=function(){if(!this.getTracks){return[];}var a=[];this.getTracks().forEach(function(b){if(b.kind.toString().indexOf("video")!==-1){a.push(b);}});return a;};MediaStream.prototype.getAudioTracks=function(){if(!this.getTracks){return[];}var a=[];this.getTracks().forEach(function(b){if(b.kind.toString().indexOf("audio")!==-1){a.push(b);}});return a;};}if(typeof MediaStream.prototype.stop==="undefined"){MediaStream.prototype.stop=function(){this.getTracks().forEach(function(a){a.stop();});};}}function bytesToSize(a){var b=1000;var d=["Bytes","KB","MB","GB","TB"];if(a===0){return"0 Bytes";}var c=parseInt(Math.floor(Math.log(a)/Math.log(b)),10);return(a/Math.pow(b,c)).toPrecision(3)+" "+d[c];}function invokeSaveAsDialog(a,h){if(!a){throw"Blob object is required.";}if(!a.type){try{a.type="video/webm";}catch(c){}}var d=(a.type||"video/webm").split("/")[1];if(h&&h.indexOf(".")!==-1){var g=h.split(".");h=g[0];d=g[1];}var b=(h||(Math.round(Math.random()*9999999999)+888888888))+"."+d;if(typeof navigator.msSaveOrOpenBlob!=="undefined"){return navigator.msSaveOrOpenBlob(a,b);}else{if(typeof navigator.msSaveBlob!=="undefined"){return navigator.msSaveBlob(a,b);}}var f=document.createElement("a");f.href=URL.createObjectURL(a);f.download=b;f.style="display:none;opacity:0;color:transparent;";(document.body||document.documentElement).appendChild(f);if(typeof f.click==="function"){f.click();}else{f.target="_blank";f.dispatchEvent(new MouseEvent("click",{view:window,bubbles:true,cancelable:true}));}URL.revokeObjectURL(f.href);}function isElectron(){if(typeof window!=="undefined"&&typeof window.process==="object"&&window.process.type==="renderer"){return true;}if(typeof process!=="undefined"&&typeof process.versions==="object"&&!!process.versions.electron){return true;}if(typeof navigator==="object"&&typeof navigator.userAgent==="string"&&navigator.userAgent.indexOf("Electron")>=0){return true;}return false;}function setSrcObject(d,b,a){if("createObjectURL" in URL&&!a){try{b.src=URL.createObjectURL(d);}catch(c){setSrcObject(d,b,true);return;}}else{if("srcObject" in b){b.srcObject=d;}else{if("mozSrcObject" in b){b.mozSrcObject=d;}else{alert("createObjectURL/srcObject both are not supported.");}}}}var Storage={};if(typeof AudioContext!=="undefined"){Storage.AudioContext=AudioContext;}else{if(typeof webkitAudioContext!=="undefined"){Storage.AudioContext=webkitAudioContext;}}if(typeof RecordRTC!=="undefined"){RecordRTC.Storage=Storage;}function isMediaRecorderCompatible(){var c=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0;var a=(!!window.chrome&&!c)||isElectron();var b=typeof window.InstallTrigger!=="undefined";if(b){return true;}var i=navigator.appVersion;var g=navigator.userAgent;var h=""+parseFloat(navigator.appVersion);var f=parseInt(navigator.appVersion,10);var j,d,e;if(a||c){d=g.indexOf("Chrome");h=g.substring(d+7);}if((e=h.indexOf(";"))!==-1){h=h.substring(0,e);}if((e=h.indexOf(" "))!==-1){h=h.substring(0,e);}f=parseInt(""+h,10);if(isNaN(f)){h=""+parseFloat(navigator.appVersion);f=parseInt(navigator.appVersion,10);}return f>=49;}function MediaStreamRecorder(l,d){var k=this;if(typeof l==="undefined"){throw'First argument "MediaStream" is required.';}if(typeof MediaRecorder==="undefined"){throw"Your browser does not supports Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";}d=d||{mimeType:"video/webm"};if(d.type==="audio"){if(l.getVideoTracks().length&&l.getAudioTracks().length){var j;if(!!navigator.mozGetUserMedia){j=new MediaStream();j.addTrack(l.getAudioTracks()[0]);}else{j=new MediaStream(l.getAudioTracks());}l=j;}if(!d.mimeType||d.mimeType.toString().toLowerCase().indexOf("audio")===-1){d.mimeType=isChrome?"audio/webm":"audio/ogg";}if(d.mimeType&&d.mimeType.toString().toLowerCase()!=="audio/ogg"&&!!navigator.mozGetUserMedia){d.mimeType="audio/ogg";}}var f=[];this.getArrayOfBlobs=function(){return f;};this.record=function(){k.blob=null;k.clearRecordedData();k.timestamps=[];c=[];f=[];var m=d;if(!d.disableLogs){console.log("Passing following config over MediaRecorder API.",m);}if(b){b=null;}if(isChrome&&!isMediaRecorderCompatible()){m="video/vp8";}if(typeof MediaRecorder.isTypeSupported==="function"&&m.mimeType){if(!MediaRecorder.isTypeSupported(m.mimeType)){if(!d.disableLogs){console.warn("MediaRecorder API seems unable to record mimeType:",m.mimeType);}m.mimeType=d.type==="audio"?"audio/webm":"video/webm";}}try{b=new MediaRecorder(l,m);d.mimeType=m.mimeType;}catch(n){b=new MediaRecorder(l);}if(m.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType" in b&&b.canRecordMimeType(m.mimeType)===false){if(!d.disableLogs){console.warn("MediaRecorder API seems unable to record mimeType:",m.mimeType);}}b.ondataavailable=function(p){if(p.data){c.push("ondataavailable: "+bytesToSize(p.data.size));}if(typeof d.timeSlice==="number"){if(p.data&&p.data.size&&p.data.size>100){f.push(p.data);e();if(typeof d.ondataavailable==="function"){var o=d.getNativeBlob?p.data:new Blob([p.data],{type:g(m)});d.ondataavailable(o);}}return;}if(!p.data||!p.data.size||p.data.size<100||k.blob){if(k.recordingCallback){k.recordingCallback(new Blob([],{type:g(m)}));k.recordingCallback=null;}return;}k.blob=d.getNativeBlob?p.data:new Blob([p.data],{type:g(m)});if(k.recordingCallback){k.recordingCallback(k.blob);k.recordingCallback=null;}};b.onstart=function(){c.push("started");};b.onpause=function(){c.push("paused");};b.onresume=function(){c.push("resumed");};b.onstop=function(){c.push("stopped");};b.onerror=function(o){c.push("error: "+o);if(!d.disableLogs){if(o.name.toString().toLowerCase().indexOf("invalidstate")!==-1){console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",o);}else{if(o.name.toString().toLowerCase().indexOf("notsupported")!==-1){console.error("MIME type (",m.mimeType,") is not supported.",o);
}else{if(o.name.toString().toLowerCase().indexOf("security")!==-1){console.error("MediaRecorder security error",o);}else{if(o.name==="OutOfMemory"){console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",o);}else{if(o.name==="IllegalStreamModification"){console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",o);}else{if(o.name==="OtherRecordingError"){console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",o);}else{if(o.name==="GenericError"){console.error("The UA cannot provide the codec or recording option that has been requested.",o);}else{console.error("MediaRecorder Error",o);}}}}}}}}(function(p){if(!k.manuallyStopped&&b&&b.state==="inactive"){delete d.timeslice;b.start(10*60*1000);return;}setTimeout(p,1000);})();if(b.state!=="inactive"&&b.state!=="stopped"){b.stop();}};if(typeof d.timeSlice==="number"){e();b.start(d.timeSlice);}else{b.start(3600000);}if(d.initCallback){d.initCallback();}};this.timestamps=[];function e(){k.timestamps.push(new Date().getTime());if(typeof d.onTimeStamp==="function"){d.onTimeStamp(k.timestamps[k.timestamps.length-1],k.timestamps);}}function g(m){if(b&&b.mimeType){return b.mimeType;}return m.mimeType||"video/webm";}this.stop=function(m){m=m||function(){};k.manuallyStopped=true;if(!b){return;}this.recordingCallback=m;if(b.state==="recording"){b.stop();}if(typeof d.timeSlice==="number"){setTimeout(function(){k.blob=new Blob(f,{type:g(d)});k.recordingCallback(k.blob);},100);}};this.pause=function(){if(!b){return;}if(b.state==="recording"){b.pause();}};this.resume=function(){if(!b){return;}if(b.state==="paused"){b.resume();}};this.clearRecordedData=function(){if(b&&b.state==="recording"){k.stop(a);}a();};function a(){f=[];b=null;k.timestamps=[];}var b;this.getInternalRecorder=function(){return b;};function h(){if("active" in l){if(!l.active){return false;}}else{if("ended" in l){if(l.ended){return false;}}}return true;}this.blob=null;this.getState=function(){if(!b){return"inactive";}return b.state||"inactive";};var c=[];this.getAllStates=function(){return c;};if(typeof d.checkForInactiveTracks==="undefined"){d.checkForInactiveTracks=false;}var k=this;(function i(){if(!b||d.checkForInactiveTracks===false){return;}if(h()===false){if(!d.disableLogs){console.log("MediaStream seems stopped.");}k.stop();return;}setTimeout(i,1000);})();this.name="MediaStreamRecorder";this.toString=function(){return this.name;};}if(typeof RecordRTC!=="undefined"){RecordRTC.MediaStreamRecorder=MediaStreamRecorder;}function StereoAudioRecorder(s,x){if(!s.getAudioTracks().length){throw"Your stream has no audio tracks.";}x=x||{};var p=this;var n=[];var u=[];var a=false;var q=0;var w;var v=2;var b=x.desiredSampRate;if(x.leftChannel===true){v=1;}if(x.numberOfAudioChannels===1){v=1;}if(!v||v<1){v=2;}if(!x.disableLogs){console.log("StereoAudioRecorder is set to record number of channels: ",v);}if(typeof x.checkForInactiveTracks==="undefined"){x.checkForInactiveTracks=true;}function d(){if(x.checkForInactiveTracks===false){return true;}if("active" in s){if(!s.active){return false;}}else{if("ended" in s){if(s.ended){return false;}}}return true;}this.record=function(){if(d()===false){throw"Please make sure MediaStream is active.";}i();l=k=false;a=true;if(typeof x.timeSlice!=="undefined"){h();}};function y(B,C){function A(X,R){var W=X.numberOfAudioChannels;var O=X.leftBuffers.slice(0);var J=X.rightBuffers.slice(0);var G=X.sampleRate;var S=X.internalInterleavedLength;var D=X.desiredSampRate;if(W===2){O=I(O,S);J=I(J,S);if(D){O=M(O,D,G);J=M(J,D,G);}}if(W===1){O=I(O,S);if(D){O=M(O,D,G);}}if(D){G=D;}function M(ab,ae,aa){var af=Math.round(ab.length*(ae/aa));var aj=[];var ai=Number((ab.length-1)/(af-1));aj[0]=ab[0];for(var ac=1;ac<af-1;ac++){var ad=ac*ai;var ah=Number(Math.floor(ad)).toFixed();var Z=Number(Math.ceil(ad)).toFixed();var ag=ad-ah;aj[ac]=F(ab[ah],ab[Z],ag);}aj[af-1]=ab[ab.length-1];return aj;}function F(aa,ab,Z){return aa+(ab-aa)*Z;}function I(ad,ae){var Z=new Float64Array(ae);var af=0;var ab=ad.length;for(var ac=0;ac<ab;ac++){var aa=ad[ac];Z.set(aa,af);af+=aa.length;}return Z;}function Q(ab,aa){var ad=ab.length+aa.length;var Z=new Float64Array(ad);var ae=0;for(var ac=0;ac<ad;){Z[ac++]=ab[ae];Z[ac++]=aa[ae];ae++;}return Z;}function H(Z,ad,ab){var aa=ab.length;for(var ac=0;ac<aa;ac++){Z.setUint8(ad+ac,ab.charCodeAt(ac));}}var P;if(W===2){P=Q(O,J);}if(W===1){P=O;}var E=P.length;var K=44+E*2;var T=new ArrayBuffer(K);var N=new DataView(T);H(N,0,"RIFF");N.setUint32(4,44+E*2,true);H(N,8,"WAVE");H(N,12,"fmt ");N.setUint32(16,16,true);N.setUint16(20,1,true);N.setUint16(22,W,true);N.setUint32(24,G,true);N.setUint32(28,G*2,true);N.setUint16(32,W*2,true);N.setUint16(34,16,true);H(N,36,"data");N.setUint32(40,E*2,true);var Y=E;var L=44;var V=1;for(var U=0;U<Y;U++){N.setInt16(L,P[U]*(32767*V),true);L+=2;}if(R){return R({buffer:T,view:N});}postMessage({buffer:T,view:N});}if(isEdge||isOpera||isSafari||B.noWorker){A(B,function(D){C(D.buffer,D.view);});return;}var z=c(A);z.onmessage=function(D){C(D.data.buffer,D.data.view);URL.revokeObjectURL(z.workerURL);};z.postMessage(B);}function c(z){var A=URL.createObjectURL(new Blob([z.toString(),";this.onmessage =  function (e) {"+z.name+"(e.data);}"],{type:"application/javascript"}));var B=new Worker(A);B.workerURL=A;return B;}this.stop=function(z){z=z||function(){};a=false;y({desiredSampRate:b,sampleRate:g,numberOfAudioChannels:v,internalInterleavedLength:q,leftBuffers:n,rightBuffers:v===1?[]:u},function(B,A){p.blob=new Blob([A],{type:"audio/wav"});p.buffer=new ArrayBuffer(A.buffer.byteLength);p.view=A;p.sampleRate=b||g;p.bufferSize=j;p.length=q;l=false;if(z){z(p.blob);}});};if(!Storage.AudioContextConstructor){Storage.AudioContextConstructor=new Storage.AudioContext();}var e=Storage.AudioContextConstructor;var m=e.createMediaStreamSource(s);var r=[0,256,512,1024,2048,4096,8192,16384];var j=typeof x.bufferSize==="undefined"?4096:x.bufferSize;if(r.indexOf(j)===-1){if(!x.disableLogs){console.warn("Legal values for buffer-size are "+JSON.stringify(r,null,"\t"));}}if(e.createJavaScriptNode){w=e.createJavaScriptNode(j,v,v);}else{if(e.createScriptProcessor){w=e.createScriptProcessor(j,v,v);}else{throw"WebAudio API has no support on this browser.";}}m.connect(w);if(!x.bufferSize){j=w.bufferSize;}var g=typeof x.sampleRate!=="undefined"?x.sampleRate:e.sampleRate||44100;if(g<22050||g>96000){if(!x.disableLogs){console.warn("sample-rate must be under range 22050 and 96000.");}}if(!x.disableLogs){console.log("sample-rate",g);console.log("buffer-size",j);if(x.desiredSampRate){console.log("Desired sample-rate",x.desiredSampRate);}}var k=false;this.pause=function(){k=true;};this.resume=function(){if(d()===false){throw"Please make sure MediaStream is active.";}if(!a){if(!x.disableLogs){console.log("Seems recording has been restarted.");}this.record();return;}k=false;};this.clearRecordedData=function(){x.checkForInactiveTracks=false;if(a){this.stop(f);}f();};function i(){n=[];u=[];q=0;l=false;a=false;k=false;e=null;p.leftchannel=n;p.rightchannel=u;p.numberOfAudioChannels=v;p.desiredSampRate=b;p.sampleRate=g;p.recordingLength=q;t={left:[],right:[],recordingLength:0};
}function f(){if(w){w.onaudioprocess=null;w.disconnect();w=null;}if(m){m.disconnect();m=null;}i();}this.name="StereoAudioRecorder";this.toString=function(){return this.name;};var l=false;function o(D){if(k){return;}if(d()===false){if(!x.disableLogs){console.log("MediaStream seems stopped.");}w.disconnect();a=false;}if(!a){if(m){m.disconnect();m=null;}return;}if(!l){l=true;if(x.onAudioProcessStarted){x.onAudioProcessStarted();}if(x.initCallback){x.initCallback();}}var C=D.inputBuffer.getChannelData(0);var B=new Float32Array(C);n.push(B);if(v===2){var A=D.inputBuffer.getChannelData(1);var z=new Float32Array(A);u.push(z);}q+=j;p.recordingLength=q;if(typeof x.timeSlice!=="undefined"){t.recordingLength+=j;t.left.push(B);if(v===2){t.right.push(z);}}}w.onaudioprocess=o;w.connect(e.destination);this.leftchannel=n;this.rightchannel=u;this.numberOfAudioChannels=v;this.desiredSampRate=b;this.sampleRate=g;p.recordingLength=q;var t={left:[],right:[],recordingLength:0};function h(){if(!a||typeof x.ondataavailable!=="function"||typeof x.timeSlice==="undefined"){return;}if(t.left.length){y({desiredSampRate:b,sampleRate:g,numberOfAudioChannels:v,internalInterleavedLength:t.recordingLength,leftBuffers:t.left,rightBuffers:v===1?[]:t.right},function(A,z){var B=new Blob([z],{type:"audio/wav"});x.ondataavailable(B);setTimeout(h,x.timeSlice);});t={left:[],right:[],recordingLength:0};}else{setTimeout(h,x.timeSlice);}}}if(typeof RecordRTC!=="undefined"){RecordRTC.StereoAudioRecorder=StereoAudioRecorder;}function CanvasRecorder(f,e){if(typeof html2canvas==="undefined"){throw"Please link: https://cdn.webrtc-experiment.com/screenshot.js";}e=e||{};if(!e.frameInterval){e.frameInterval=10;}var i=false;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(p){if(p in document.createElement("canvas")){i=true;}});var d=(!!window.webkitRTCPeerConnection||!!window.webkitGetUserMedia)&&!!window.chrome;var n=50;var l=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);if(d&&l&&l[2]){n=parseInt(l[2],10);}if(d&&n<52){i=false;}if(e.useWhammyRecorder){i=false;}var g,o;if(i){if(!e.disableLogs){console.log("Your browser supports both MediRecorder API and canvas.captureStream!");}if(f instanceof HTMLCanvasElement){g=f;}else{if(f instanceof CanvasRenderingContext2D){g=f.canvas;}else{throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";}}}else{if(!!navigator.mozGetUserMedia){if(!e.disableLogs){console.error("Canvas recording is NOT supported in Firefox.");}}}var b;this.record=function(){b=true;if(i&&!e.useWhammyRecorder){var p;if("captureStream" in g){p=g.captureStream(25);}else{if("mozCaptureStream" in g){p=g.mozCaptureStream(25);}else{if("webkitCaptureStream" in g){p=g.webkitCaptureStream(25);}}}try{var q=new MediaStream();q.addTrack(p.getVideoTracks()[0]);p=q;}catch(r){}if(!p){throw"captureStream API are NOT available.";}o=new MediaStreamRecorder(p,{mimeType:"video/webm"});o.record();}else{j.frames=[];a=new Date().getTime();m();}if(e.initCallback){e.initCallback();}};this.getWebPImages=function(q){if(f.nodeName.toLowerCase()!=="canvas"){q();return;}var p=j.frames.length;j.frames.forEach(function(u,r){var t=p-r;if(!e.disableLogs){console.log(t+"/"+p+" frames remaining");}if(e.onEncodingCallback){e.onEncodingCallback(t,p);}var s=u.image.toDataURL("image/webp",1);j.frames[r].image=s;});if(!e.disableLogs){console.log("Generating WebM");}q();};this.stop=function(q){b=false;var p=this;if(i&&o){o.stop(q);return;}this.getWebPImages(function(){j.compile(function(r){if(!e.disableLogs){console.log("Recording finished!");}p.blob=r;if(p.blob.forEach){p.blob=new Blob([],{type:"video/webm"});}if(q){q(p.blob);}j.frames=[];});});};var h=false;this.pause=function(){h=true;if(o instanceof MediaStreamRecorder){o.pause();return;}};this.resume=function(){h=false;if(o instanceof MediaStreamRecorder){o.resume();return;}if(!b){this.record();}};this.clearRecordedData=function(){if(b){this.stop(c);}c();};function c(){j.frames=[];b=false;h=false;}this.name="CanvasRecorder";this.toString=function(){return this.name;};function k(){var q=document.createElement("canvas");var p=q.getContext("2d");q.width=f.width;q.height=f.height;p.drawImage(f,0,0);return q;}function m(){if(h){a=new Date().getTime();return setTimeout(m,500);}if(f.nodeName.toLowerCase()==="canvas"){var p=new Date().getTime()-a;a=new Date().getTime();j.frames.push({image:k(),duration:p});if(b){setTimeout(m,e.frameInterval);}return;}html2canvas(f,{grabMouse:typeof e.showMousePointer==="undefined"||e.showMousePointer,onrendered:function(q){var r=new Date().getTime()-a;if(!r){return setTimeout(m,e.frameInterval);}a=new Date().getTime();j.frames.push({image:q.toDataURL("image/webp",1),duration:r});if(b){setTimeout(m,e.frameInterval);}}});}var a=new Date().getTime();var j=new Whammy.Video(100);}if(typeof RecordRTC!=="undefined"){RecordRTC.CanvasRecorder=CanvasRecorder;}function WhammyRecorder(l,f){f=f||{};if(!f.frameInterval){f.frameInterval=10;}if(!f.disableLogs){console.log("Using frames-interval:",f.frameInterval);}this.record=function(){if(!f.width){f.width=320;}if(!f.height){f.height=240;}if(!f.video){f.video={width:f.width,height:f.height};}if(!f.canvas){f.canvas={width:f.width,height:f.height};}e.width=f.canvas.width||320;e.height=f.canvas.height||240;c=e.getContext("2d");if(f.video&&f.video instanceof HTMLVideoElement){b=f.video.cloneNode();if(f.initCallback){f.initCallback();}}else{b=document.createElement("video");setSrcObject(l,b);b.onloadedmetadata=function(){if(f.initCallback){f.initCallback();}};b.width=f.video.width;b.height=f.video.height;}b.muted=true;b.play();a=new Date().getTime();k=new Whammy.Video();if(!f.disableLogs){console.log("canvas resolutions",e.width,"*",e.height);console.log("video width/height",b.width||e.width,"*",b.height||e.height);}h(f.frameInterval);};function h(n){n=typeof n!=="undefined"?n:10;var o=new Date().getTime()-a;if(!o){return setTimeout(h,n,n);}if(i){a=new Date().getTime();return setTimeout(h,100);}a=new Date().getTime();if(b.paused){b.play();}c.drawImage(b,0,0,e.width,e.height);k.frames.push({duration:o,image:e.toDataURL("image/webp")});if(!j){setTimeout(h,n,n);}}function m(r){var p=-1,q=r.length;(function n(){p++;if(p===q){r.callback();return;}setTimeout(function(){r.functionToLoop(n,p);},1);})();}function g(n,o,z,q,A){var u=document.createElement("canvas");u.width=e.width;u.height=e.height;var p=u.getContext("2d");var r=[];var t=o===-1;var v=(o&&o>0&&o<=n.length)?o:n.length;var s={r:0,g:0,b:0};var B=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2));var y=z&&z>=0&&z<=1?z:0;var w=q&&q>=0&&q<=1?q:0;var x=false;m({length:v,functionToLoop:function(C,F){var E,I,D;var H=function(){if(!x&&D-E<=D*w){}else{if(t){x=true;}r.push(n[F]);}C();};if(!x){var G=new Image();G.onload=function(){p.drawImage(G,0,0,e.width,e.height);var M=p.getImageData(0,0,e.width,e.height);E=0;I=M.data.length;D=M.data.length/4;for(var K=0;K<I;K+=4){var J={r:M.data[K],g:M.data[K+1],b:M.data[K+2]};var L=Math.sqrt(Math.pow(J.r-s.r,2)+Math.pow(J.g-s.g,2)+Math.pow(J.b-s.b,2));if(L<=B*y){E++;}}H();};G.src=n[F].image;}else{H();}},callback:function(){r=r.concat(n.slice(v));if(r.length<=0){r.push(n[n.length-1]);}A(r);}});}var j=false;this.stop=function(o){o=o||function(){};j=true;var n=this;setTimeout(function(){g(k.frames,-1,null,null,function(p){k.frames=p;if(f.advertisement&&f.advertisement.length){k.frames=f.advertisement.concat(k.frames);}k.compile(function(q){n.blob=q;if(n.blob.forEach){n.blob=new Blob([],{type:"video/webm"});
}if(o){o(n.blob);}});});},10);};var i=false;this.pause=function(){i=true;};this.resume=function(){i=false;if(j){this.record();}};this.clearRecordedData=function(){if(!j){this.stop(d);}d();};function d(){k.frames=[];j=true;i=false;}this.name="WhammyRecorder";this.toString=function(){return this.name;};var e=document.createElement("canvas");var c=e.getContext("2d");var b;var a;var k;}if(typeof RecordRTC!=="undefined"){RecordRTC.WhammyRecorder=WhammyRecorder;}var Whammy=(function(){function b(d){this.frames=[];this.duration=d||1;this.quality=0.8;}b.prototype.add=function(e,d){if("canvas" in e){e=e.canvas;}if("toDataURL" in e){e=e.toDataURL("image/webp",this.quality);}if(!(/^data:image\/webp;base64,/ig).test(e)){throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";}this.frames.push({image:e,duration:d||this.duration});};function c(d){var e=URL.createObjectURL(new Blob([d.toString(),"this.onmessage =  function (e) {"+d.name+"(e.data);}"],{type:"application/javascript"}));var f=new Worker(e);URL.revokeObjectURL(e);return f;}function a(o){function j(y){var v=p(y);if(!v){return[];}var s=30000;var w=[{"id":440786851,"data":[{"data":1,"id":17030},{"data":1,"id":17143},{"data":4,"id":17138},{"data":8,"id":17139},{"data":"webm","id":17026},{"data":2,"id":17031},{"data":2,"id":17029}]},{"id":408125543,"data":[{"id":357149030,"data":[{"data":1000000,"id":2807729},{"data":"whammy","id":19840},{"data":"whammy","id":22337},{"data":d(v.duration),"id":17545}]},{"id":374648427,"data":[{"id":174,"data":[{"data":1,"id":215},{"data":1,"id":29637},{"data":0,"id":156},{"data":"und","id":2274716},{"data":"V_VP8","id":134},{"data":"VP8","id":2459272},{"data":1,"id":131},{"id":224,"data":[{"data":v.width,"id":176},{"data":v.height,"id":186}]}]}]}]}];var z=0;var B=0;while(z<y.length){var x=[];var u=0;do{x.push(y[z]);u+=y[z].duration;z++;}while(z<y.length&&u<s);var t=0;var A={"id":524531317,"data":i(B,t,x)};w[1].data.push(A);B+=u;}return q(w);}function i(t,u,s){return[{"data":t,"id":231}].concat(s.map(function(v){var w=r({discardable:0,frame:v.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(u)});u+=v.duration;return{data:w,id:163};}));}function p(w){if(!w[0]){postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});return;}var u=w[0].width,s=w[0].height,v=w[0].duration;for(var t=1;t<w.length;t++){v+=w[t].duration;}return{duration:v,width:u,height:s};}function f(s){var t=[];while(s>0){t.push(s&255);s=s>>8;}return new Uint8Array(t.reverse());}function m(s){return new Uint8Array(s.split("").map(function(t){return t.charCodeAt(0);}));}function h(u){var t=[];var v=(u.length%8)?(new Array(1+8-(u.length%8))).join("0"):"";u=v+u;for(var s=0;s<u.length;s+=8){t.push(parseInt(u.substr(s,8),2));}return new Uint8Array(t);}function q(z){var u=[];for(var w=0;w<z.length;w++){var v=z[w].data;if(typeof v==="object"){v=q(v);}if(typeof v==="number"){v=h(v.toString(2));}if(typeof v==="string"){v=m(v);}var x=v.size||v.byteLength||v.length;var y=Math.ceil(Math.ceil(Math.log(x)/Math.log(2))/8);var s=x.toString(2);var t=(new Array((y*7+7+1)-s.length)).join("0")+s;var A=(new Array(y)).join("0")+"1"+t;u.push(f(z[w].id));u.push(h(A));u.push(v);}return new Blob(u,{type:"video/webm"});}function l(u){var t="";var v=(u.length%8)?(new Array(1+8-(u.length%8))).join("0"):"";u=v+u;for(var s=0;s<u.length;s+=8){t+=String.fromCharCode(parseInt(u.substr(s,8),2));}return t;}function r(u){var s=0;if(u.keyframe){s|=128;}if(u.invisible){s|=8;}if(u.lacing){s|=(u.lacing<<1);}if(u.discardable){s|=1;}if(u.trackNum>127){throw"TrackNumber > 127 not supported";}var t=[u.trackNum|128,u.timecode>>8,u.timecode&255,s].map(function(v){return String.fromCharCode(v);}).join("")+u.frame;return t;}function g(z){var t=z.RIFF[0].WEBP[0];var x=t.indexOf("\x9d\x01\x2a");for(var v=0,y=[];v<4;v++){y[v]=t.charCodeAt(x+3+v);}var w,s,u;u=(y[1]<<8)|y[0];w=u&16383;u=(y[3]<<8)|y[2];s=u&16383;return{width:w,height:s,data:t,riff:z};}function n(s,t){return parseInt(s.substr(t+4,4).split("").map(function(u){var v=u.charCodeAt(0).toString(2);return(new Array(8-v.length+1)).join("0")+v;}).join(""),2);}function k(t){var v=0;var x={};while(v<t.length){var w=t.substr(v,4);var s=n(t,v);var u=t.substr(v+4+4,s);v+=4+4+s;x[w]=x[w]||[];if(w==="RIFF"||w==="LIST"){x[w].push(k(u));}else{x[w].push(u);}}return x;}function d(s){return[].slice.call(new Uint8Array((new Float64Array([s])).buffer),0).map(function(t){return String.fromCharCode(t);}).reverse().join("");}var e=new j(o.map(function(t){var s=g(k(atob(t.image.slice(23))));s.duration=t.duration;return s;}));postMessage(e);}b.prototype.compile=function(e){var d=c(a);d.onmessage=function(f){if(f.data.error){console.error(f.data.error);return;}e(f.data);};d.postMessage(this.frames);};return{Video:b};})();if(typeof RecordRTC!=="undefined"){RecordRTC.Whammy=Whammy;}var DiskStorage={init:function(){var b=this;if(typeof indexedDB==="undefined"||typeof indexedDB.open==="undefined"){console.error("IndexedDB API are not available in this browser.");return;}var c=1;var f=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),a;var e=indexedDB.open(f,c);function d(h){h.createObjectStore(b.dataStoreName);}function g(){var i=a.transaction([b.dataStoreName],"readwrite");if(b.videoBlob){i.objectStore(b.dataStoreName).put(b.videoBlob,"videoBlob");}if(b.gifBlob){i.objectStore(b.dataStoreName).put(b.gifBlob,"gifBlob");}if(b.audioBlob){i.objectStore(b.dataStoreName).put(b.audioBlob,"audioBlob");}function h(j){i.objectStore(b.dataStoreName).get(j).onsuccess=function(k){if(b.callback){b.callback(k.target.result,j);}};}h("audioBlob");h("videoBlob");h("gifBlob");}e.onerror=b.onError;e.onsuccess=function(){a=e.result;a.onerror=b.onError;if(a.setVersion){if(a.version!==c){var h=a.setVersion(c);h.onsuccess=function(){d(a);g();};}else{g();}}else{g();}};e.onupgradeneeded=function(h){d(h.target.result);};},Fetch:function(a){this.callback=a;this.init();return this;},Store:function(a){this.audioBlob=a.audioBlob;this.videoBlob=a.videoBlob;this.gifBlob=a.gifBlob;this.init();return this;},onError:function(a){console.error(JSON.stringify(a,null,"\t"));},dataStoreName:"recordRTC",dbName:null};if(typeof RecordRTC!=="undefined"){RecordRTC.DiskStorage=DiskStorage;}function GifRecorder(p,f){if(typeof GIFEncoder==="undefined"){var k=document.createElement("script");k.src="https://cdn.webrtc-experiment.com/gif-recorder.js";(document.body||document.documentElement).appendChild(k);}f=f||{};var j=p instanceof CanvasRenderingContext2D||p instanceof HTMLCanvasElement;this.record=function(){if(typeof GIFEncoder==="undefined"){setTimeout(n.record,1000);return;}if(!i){setTimeout(n.record,1000);return;}if(!j){if(!f.width){f.width=a.offsetWidth||320;}if(!f.height){f.height=a.offsetHeight||240;}if(!f.video){f.video={width:f.width,height:f.height};}if(!f.canvas){f.canvas={width:f.width,height:f.height};}e.width=f.canvas.width||320;e.height=f.canvas.height||240;a.width=f.video.width||320;a.height=f.video.height||240;}l=new GIFEncoder();l.setRepeat(0);l.setDelay(f.frameRate||200);l.setQuality(f.quality||10);l.start();if(typeof f.onGifRecordingStarted==="function"){f.onGifRecordingStarted();}d=Date.now();function q(r){if(n.clearedRecordedData===true){return;}if(g){return setTimeout(function(){q(r);},100);}m=requestAnimationFrame(q);if(typeof o===undefined){o=r;}if(r-o<90){return;}if(!j&&a.paused){a.play();}if(!j){c.drawImage(a,0,0,e.width,e.height);}if(f.onGifPreview){f.onGifPreview(e.toDataURL("image/png"));
}l.addFrame(c);o=r;}m=requestAnimationFrame(q);if(f.initCallback){f.initCallback();}};this.stop=function(q){q=q||function(){};if(m){cancelAnimationFrame(m);}h=Date.now();this.blob=new Blob([new Uint8Array(l.stream().bin)],{type:"image/gif"});q(this.blob);l.stream().bin=[];};var g=false;this.pause=function(){g=true;};this.resume=function(){g=false;};this.clearRecordedData=function(){n.clearedRecordedData=true;b();};function b(){if(l){l.stream().bin=[];}}this.name="GifRecorder";this.toString=function(){return this.name;};var e=document.createElement("canvas");var c=e.getContext("2d");if(j){if(p instanceof CanvasRenderingContext2D){c=p;e=c.canvas;}else{if(p instanceof HTMLCanvasElement){c=p.getContext("2d");e=p;}}}var i=true;if(!j){var a=document.createElement("video");a.muted=true;a.autoplay=true;i=false;a.onloadedmetadata=function(){i=true;};setSrcObject(p,a);a.play();}var m=null;var d,h,o;var l;var n=this;}if(typeof RecordRTC!=="undefined"){RecordRTC.GifRecorder=GifRecorder;}function MultiStreamsMixer(k){var j=[];var o=false;var c=document.createElement("canvas");var a=c.getContext("2d");c.style="opacity:0;position:absolute;z-index:-1;top: -100000000;left:-1000000000; margin-top:-1000000000;margin-left:-1000000000;";(document.body||document.documentElement).appendChild(c);this.disableLogs=false;this.frameInterval=10;this.width=360;this.height=240;this.useGainNode=true;var l=this;var f=window.AudioContext;if(typeof f==="undefined"){if(typeof webkitAudioContext!=="undefined"){f=webkitAudioContext;}if(typeof mozAudioContext!=="undefined"){f=mozAudioContext;}}var g=window.URL;if(typeof g==="undefined"&&typeof webkitURL!=="undefined"){g=webkitURL;}if(typeof navigator!=="undefined"&&typeof navigator.getUserMedia==="undefined"){if(typeof navigator.webkitGetUserMedia!=="undefined"){navigator.getUserMedia=navigator.webkitGetUserMedia;}if(typeof navigator.mozGetUserMedia!=="undefined"){navigator.getUserMedia=navigator.mozGetUserMedia;}}var h=window.MediaStream;if(typeof h==="undefined"&&typeof webkitMediaStream!=="undefined"){h=webkitMediaStream;}if(typeof h!=="undefined"){if(!("getVideoTracks" in h.prototype)){h.prototype.getVideoTracks=function(){if(!this.getTracks){return[];}var s=[];this.getTracks.forEach(function(t){if(t.kind.toString().indexOf("video")!==-1){s.push(t);}});return s;};h.prototype.getAudioTracks=function(){if(!this.getTracks){return[];}var s=[];this.getTracks.forEach(function(t){if(t.kind.toString().indexOf("audio")!==-1){s.push(t);}});return s;};}if(typeof h.prototype.stop==="undefined"){h.prototype.stop=function(){this.getTracks().forEach(function(s){s.stop();});};}}var q={};if(typeof f!=="undefined"){q.AudioContext=f;}else{if(typeof webkitAudioContext!=="undefined"){q.AudioContext=webkitAudioContext;}}function r(v,t,s){if("createObjectURL" in g&&!s){try{t.src=g.createObjectURL(v);}catch(u){r(v,t,true);return;}}else{if("srcObject" in t){t.srcObject=v;}else{if("mozSrcObject" in t){t.mozSrcObject=v;}else{alert("createObjectURL/srcObject both are not supported.");}}}}this.startDrawingFrames=function(){p();};function p(){if(o){return;}var t=j.length;var v=false;var u=[];j.forEach(function(w){if(!w.stream){w.stream={};}if(w.stream.fullcanvas){v=w;}else{u.push(w);}});if(v){c.width=v.stream.width;c.height=v.stream.height;}else{if(u.length){c.width=t>1?u[0].width*2:u[0].width;var s=1;if(t===3||t===4){s=2;}if(t===5||t===6){s=3;}if(t===7||t===8){s=4;}if(t===9||t===10){s=5;}c.height=u[0].height*s;}else{c.width=l.width||360;c.height=l.height||240;}}if(v&&v instanceof HTMLVideoElement){n(v);}u.forEach(function(x,w){n(x,w);});setTimeout(p,l.frameInterval);}function n(w,u){if(o){return;}var t=0;var z=0;var v=w.width;var s=w.height;if(u===1){t=w.width;}if(u===2){z=w.height;}if(u===3){t=w.width;z=w.height;}if(u===4){z=w.height*2;}if(u===5){t=w.width;z=w.height*2;}if(u===6){z=w.height*3;}if(u===7){t=w.width;z=w.height*3;}if(typeof w.stream.left!=="undefined"){t=w.stream.left;}if(typeof w.stream.top!=="undefined"){z=w.stream.top;}if(typeof w.stream.width!=="undefined"){v=w.stream.width;}if(typeof w.stream.height!=="undefined"){s=w.stream.height;}a.drawImage(w,t,z,v,s);if(typeof w.stream.onRender==="function"){w.stream.onRender(a,t,z,v,s,u);}}function i(){o=false;var t=b();var u=m();if(u){u.getAudioTracks().forEach(function(v){t.addTrack(v);});}var s;k.forEach(function(v){if(v.fullcanvas){s=true;}});return t;}function b(){e();var t;if("captureStream" in c){t=c.captureStream();}else{if("mozCaptureStream" in c){t=c.mozCaptureStream();}else{if(!l.disableLogs){console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");}}}var s=new h();t.getVideoTracks().forEach(function(u){s.addTrack(u);});c.stream=s;return s;}function m(){if(!q.AudioContextConstructor){q.AudioContextConstructor=new q.AudioContext();}l.audioContext=q.AudioContextConstructor;l.audioSources=[];if(l.useGainNode===true){l.gainNode=l.audioContext.createGain();l.gainNode.connect(l.audioContext.destination);l.gainNode.gain.value=0;}var s=0;k.forEach(function(u){if(!u.getAudioTracks().length){return;}s++;var t=l.audioContext.createMediaStreamSource(u);if(l.useGainNode===true){t.connect(l.gainNode);}l.audioSources.push(t);});if(!s){return;}l.audioDestination=l.audioContext.createMediaStreamDestination();l.audioSources.forEach(function(t){t.connect(l.audioDestination);});return l.audioDestination.stream;}function d(t){var s=document.createElement("video");r(t,s);s.muted=true;s.volume=0;s.width=t.width||l.width||360;s.height=t.height||l.height||240;s.play();return s;}this.appendStreams=function(s){if(!s){throw"First parameter is required.";}if(!(s instanceof Array)){s=[s];}k.concat(s);s.forEach(function(v){if(v.getVideoTracks().length){var u=d(v);u.stream=v;j.push(u);}if(v.getAudioTracks().length&&l.audioContext){var t=l.audioContext.createMediaStreamSource(v);t.connect(l.audioDestination);l.audioSources.push(t);}});};this.releaseStreams=function(){j=[];o=true;if(l.gainNode){l.gainNode.disconnect();l.gainNode=null;}if(l.audioSources.length){l.audioSources.forEach(function(s){s.disconnect();});l.audioSources=[];}if(l.audioDestination){l.audioDestination.disconnect();l.audioDestination=null;}if(l.audioContext){l.audioContext.close();}l.audioContext=null;a.clearRect(0,0,c.width,c.height);if(c.stream){c.stream.stop();c.stream=null;}};this.resetVideoStreams=function(s){if(s&&!(s instanceof Array)){s=[s];}e(s);};function e(s){j=[];s=s||k;s.forEach(function(u){if(!u.getVideoTracks().length){return;}var t=d(u);t.stream=u;j.push(t);});}this.name="MultiStreamsMixer";this.toString=function(){return this.name;};this.getMixedStream=i;}function MultiStreamRecorder(a,d){a=a||[];var c=this;var b;var f;d=d||{mimeType:"video/webm",video:{width:360,height:240}};if(!d.frameInterval){d.frameInterval=10;}if(!d.video){d.video={};}if(!d.video.width){d.video.width=360;}if(!d.video.height){d.video.height=240;}this.record=function(){b=new MultiStreamsMixer(a);if(e().length){b.frameInterval=d.frameInterval||10;b.width=d.video.width||360;b.height=d.video.height||240;b.startDrawingFrames();}if(d.previewStream&&typeof d.previewStream==="function"){d.previewStream(b.getMixedStream());}f=new MediaStreamRecorder(b.getMixedStream(),d);f.record();};function e(){var g=[];a.forEach(function(h){h.getVideoTracks().forEach(function(i){g.push(i);});});return g;}this.stop=function(g){if(!f){return;}f.stop(function(h){c.blob=h;g(h);c.clearRecordedData();});};this.pause=function(){if(f){f.pause();
}};this.resume=function(){if(f){f.resume();}};this.clearRecordedData=function(){if(f){f.clearRecordedData();f=null;}if(b){b.releaseStreams();b=null;}};this.addStreams=function(g){if(!g){throw"First parameter is required.";}if(!(g instanceof Array)){g=[g];}a.concat(g);if(!f||!b){return;}b.appendStreams(g);};this.resetVideoStreams=function(g){if(!b){return;}if(g&&!(g instanceof Array)){g=[g];}b.resetVideoStreams(g);};this.name="MultiStreamRecorder";this.toString=function(){return this.name;};}if(typeof RecordRTC!=="undefined"){RecordRTC.MultiStreamRecorder=MultiStreamRecorder;}function RecordRTCPromisesHandler(b,c){if(!this){throw'Use "new RecordRTCPromisesHandler()"';}if(typeof b==="undefined"){throw'First argument "MediaStream" is required.';}var a=this;a.recordRTC=new RecordRTC(b,c);this.startRecording=function(){return new Promise(function(f,d){try{a.recordRTC.startRecording();f();}catch(g){d(g);}});};this.stopRecording=function(){return new Promise(function(f,d){try{a.recordRTC.stopRecording(function(e){a.blob=a.recordRTC.getBlob();f(e);});}catch(g){d(g);}});};this.getDataURL=function(d){return new Promise(function(g,f){try{a.recordRTC.getDataURL(function(e){g(e);});}catch(h){f(h);}});};this.getBlob=function(){return a.recordRTC.getBlob();};this.blob=null;}if(typeof RecordRTC!=="undefined"){RecordRTC.RecordRTCPromisesHandler=RecordRTCPromisesHandler;}